import pandas as pd
import numpy as np

# Load the dataset
# Assuming the CSV file has columns: 'City', 'Date', 'Temperature'
df = pd.read_csv('daily_temperatures.csv')

# Ensure 'Date' column is of datetime type
df['Date'] = pd.to_datetime(df['Date'])

# Group by city to perform calculations
grouped = df.groupby('City')['Temperature']

# Calculate mean temperature for each city
mean_temperatures = grouped.mean()
print("Mean temperature for each city:")
print(mean_temperatures)

# Calculate standard deviation of temperature for each city
std_devs = grouped.std()
print("\nStandard deviation of temperature for each city:")
print(std_devs)

# Determine the city with the highest temperature range
temperature_ranges = grouped.max() - grouped.min()
city_highest_range = temperature_ranges.idxmax()
highest_range_value = temperature_ranges.max()
print("\nCity with the highest temperature range:")
print(f"{city_highest_range} with a range of {highest_range_value:.2f} degrees")

# Find the city with the most consistent temperature (lowest standard deviation)
city_most_consistent = std_devs.idxmin()
lowest_std_dev_value = std_devs.min()
print("\nCity with the most consistent temperature:")
print(f"{city_most_consistent} with a standard deviation of {lowest_std_dev_value:.2f} degrees")
